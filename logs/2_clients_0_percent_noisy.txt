

=================================

Dataset: ADULT 
Number of attributes: 11 
Number of labels: 1 
Number of rows: 32561 
Postive ratio: 0.2408095574460244
(2,)
attribute_split_array:  [6 6]
Successful attribute split for multiple organizations

The current vertical FL has a non-configurable structure.
Reconfigurable vertical FL can be achieved by simply changing the attribute group split!
Ming revised the codes on 12/11/2021 to realize re-configurable vertical FL.

There are 2 participant organizations:
The attributes held by Organization 0: ['age', 'workclass', 'fnlwgt', 'marital-status', 'occupation', 'relationship']
The attributes held by Organization 1: ['race', 'sex', 'capital-gain', 'capital-loss', 'hours-per-week', 'native-country']
{0: array([['State-gov', 77516, 'Bachelors', 'Never-married', 'Adm-clerical',
        'Not-in-family'],
       ['Self-emp-not-inc', 83311, 'Bachelors', 'Married-civ-spouse',
        'Exec-managerial', 'Husband'],
       ['Private', 215646, 'HS-grad', 'Divorced', 'Handlers-cleaners',
        'Not-in-family'],
       ...,
       ['Private', 151910, 'HS-grad', 'Widowed', 'Adm-clerical',
        'Unmarried'],
       ['Private', 201490, 'HS-grad', 'Never-married', 'Adm-clerical',
        'Own-child'],
       ['Self-emp-inc', 287927, 'HS-grad', 'Married-civ-spouse',
        'Exec-managerial', 'Wife']], dtype=object)}
vertical split data for organization 0: [['State-gov' 77516 'Bachelors' 'Never-married' 'Adm-clerical'
  'Not-in-family']
 ['Self-emp-not-inc' 83311 'Bachelors' 'Married-civ-spouse'
  'Exec-managerial' 'Husband']
 ['Private' 215646 'HS-grad' 'Divorced' 'Handlers-cleaners'
  'Not-in-family']
 ...
 ['Private' 151910 'HS-grad' 'Widowed' 'Adm-clerical' 'Unmarried']
 ['Private' 201490 'HS-grad' 'Never-married' 'Adm-clerical' 'Own-child']
 ['Self-emp-inc' 287927 'HS-grad' 'Married-civ-spouse' 'Exec-managerial'
  'Wife']]
encoded vertical split data for organization 0: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 1. 0.]
 [0. 0. 0. ... 1. 0. 0.]
 [0. 0. 0. ... 0. 0. 1.]]
The shape of the encoded dataset held by Organization 0: (32561, 21701)
{0: array([['State-gov', 77516, 'Bachelors', 'Never-married', 'Adm-clerical',
        'Not-in-family'],
       ['Self-emp-not-inc', 83311, 'Bachelors', 'Married-civ-spouse',
        'Exec-managerial', 'Husband'],
       ['Private', 215646, 'HS-grad', 'Divorced', 'Handlers-cleaners',
        'Not-in-family'],
       ...,
       ['Private', 151910, 'HS-grad', 'Widowed', 'Adm-clerical',
        'Unmarried'],
       ['Private', 201490, 'HS-grad', 'Never-married', 'Adm-clerical',
        'Own-child'],
       ['Self-emp-inc', 287927, 'HS-grad', 'Married-civ-spouse',
        'Exec-managerial', 'Wife']], dtype=object), 1: array([['White', 'Male', 2174, 0, 40, 'United-States'],
       ['White', 'Male', 0, 0, 13, 'United-States'],
       ['White', 'Male', 0, 0, 40, 'United-States'],
       ...,
       ['White', 'Female', 0, 0, 40, 'United-States'],
       ['White', 'Male', 0, 0, 20, 'United-States'],
       ['White', 'Female', 15024, 0, 40, 'United-States']], dtype=object)}
vertical split data for organization 1: [['White' 'Male' 2174 0 40 'United-States']
 ['White' 'Male' 0 0 13 'United-States']
 ['White' 'Male' 0 0 40 'United-States']
 ...
 ['White' 'Female' 0 0 40 'United-States']
 ['White' 'Male' 0 0 20 'United-States']
 ['White' 'Female' 15024 0 40 'United-States']]
encoded vertical split data for organization 1: [[0. 0. 0. ... 1. 0. 0.]
 [0. 0. 0. ... 1. 0. 0.]
 [0. 0. 0. ... 1. 0. 0.]
 ...
 [0. 0. 0. ... 1. 0. 0.]
 [0. 0. 0. ... 1. 0. 0.]
 [0. 0. 0. ... 1. 0. 0.]]
The shape of the encoded dataset held by Organization 1: (32561, 354)
X shape: (32561, 12)
attribute groups: [['age', 'workclass', 'fnlwgt', 'marital-status', 'occupation', 'relationship'], ['race', 'sex', 'capital-gain', 'capital-loss', 'hours-per-week', 'native-country']]
{0: array([[0., 0., 0., ..., 1., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 1., 0.],
       ...,
       [0., 0., 0., ..., 1., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 1., 0., 0.]])} {0: array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 1., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [1., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 1.]])}

Start vertical FL......

organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 9.3900e-03],
        [0.0000e+00, 4.8582e-01],
        [0.0000e+00, 1.8413e-02],
        ...,
        [0.0000e+00, 4.6361e-04],
        [0.0000e+00, 9.8496e-02],
        [0.0000e+00, 3.3493e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([9.3900e-03, 4.8582e-01, 1.8413e-02,  ..., 4.6361e-04, 9.8496e-02,
        3.3493e-03], grad_fn=<SelectBackward0>)
epoch: 1, train loss: 0.24016904830932617, test auc: 0.917568736361732 test acc: 0.8638108398587441
X_example shape:  1599
Organization  0  contribution:  0.00279764
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  -0.00078344
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [1 0]
tokens per organization:  {0: 47, 1: 47}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000, 0.0434],
        [0.0000, 0.9348],
        [0.0000, 0.0184],
        ...,
        [0.0000, 0.0015],
        [0.0000, 0.0053],
        [0.0000, 0.0183]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([0.0434, 0.9348, 0.0184,  ..., 0.0015, 0.0053, 0.0183],
       grad_fn=<SelectBackward0>)
epoch: 2, train loss: 0.2649678885936737, test auc: 0.8842437008478284 test acc: 0.8142177184093352
X_example shape:  1599
Organization  0  contribution:  0.00319852
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00092007
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [1 0]
tokens per organization:  {0: -6, 1: -6}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.5556e-02],
        [0.0000e+00, 8.3274e-01],
        [0.0000e+00, 6.8947e-04],
        ...,
        [0.0000e+00, 3.5420e-04],
        [0.0000e+00, 3.0612e-03],
        [0.0000e+00, 5.8028e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.5556e-02, 8.3274e-01, 6.8947e-04,  ..., 3.5420e-04, 3.0612e-03,
        5.8028e-03], grad_fn=<SelectBackward0>)
epoch: 3, train loss: 0.10455416887998581, test auc: 0.8815659359749416 test acc: 0.8380162751420236
X_example shape:  1599
Organization  0  contribution:  0.00171284
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00133866
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [1 0]
tokens per organization:  {0: -59, 1: -59}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 4.7864e-03],
        [0.0000e+00, 6.8972e-01],
        [0.0000e+00, 8.9307e-04],
        ...,
        [0.0000e+00, 2.1247e-04],
        [0.0000e+00, 6.7010e-03],
        [0.0000e+00, 5.8835e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([4.7864e-03, 6.8972e-01, 8.9307e-04,  ..., 2.1247e-04, 6.7010e-03,
        5.8835e-03], grad_fn=<SelectBackward0>)
epoch: 4, train loss: 0.33334460854530334, test auc: 0.8801357075278277 test acc: 0.8361738062336864
X_example shape:  1599
Organization  0  contribution:  0.00131381
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00131460
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -112, 1: -112}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 8.3825e-03],
        [0.0000e+00, 6.5955e-01],
        [0.0000e+00, 5.3893e-04],
        ...,
        [0.0000e+00, 1.4904e-04],
        [0.0000e+00, 2.2636e-03],
        [0.0000e+00, 4.8562e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([8.3825e-03, 6.5955e-01, 5.3893e-04,  ..., 1.4904e-04, 2.2636e-03,
        4.8562e-03], grad_fn=<SelectBackward0>)
epoch: 5, train loss: 0.16490718722343445, test auc: 0.8799555608498697 test acc: 0.8303393213572854
X_example shape:  1599
Organization  0  contribution:  0.00100132
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00219074
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -165, 1: -165}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 2.3942e-02],
        [0.0000e+00, 7.4651e-01],
        [0.0000e+00, 3.9049e-04],
        ...,
        [0.0000e+00, 3.7058e-04],
        [0.0000e+00, 1.6530e-03],
        [0.0000e+00, 8.2892e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([2.3942e-02, 7.4651e-01, 3.9049e-04,  ..., 3.7058e-04, 1.6530e-03,
        8.2892e-03], grad_fn=<SelectBackward0>)
epoch: 6, train loss: 0.2529791593551636, test auc: 0.8802608747887046 test acc: 0.8343313373253493
X_example shape:  1599
Organization  0  contribution:  0.00091565
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00214401
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -218, 1: -218}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 8.0809e-03],
        [0.0000e+00, 8.2940e-01],
        [0.0000e+00, 2.1974e-04],
        ...,
        [0.0000e+00, 6.0473e-05],
        [0.0000e+00, 2.3288e-04],
        [0.0000e+00, 2.5459e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([8.0809e-03, 8.2940e-01, 2.1974e-04,  ..., 6.0473e-05, 2.3288e-04,
        2.5459e-03], grad_fn=<SelectBackward0>)
epoch: 7, train loss: 0.11936554312705994, test auc: 0.8736507452892693 test acc: 0.8377091969906341
X_example shape:  1599
Organization  0  contribution:  0.00060172
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00180772
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -271, 1: -271}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 2.9828e-02],
        [0.0000e+00, 7.6321e-01],
        [0.0000e+00, 3.0313e-04],
        ...,
        [0.0000e+00, 2.1603e-04],
        [0.0000e+00, 3.8087e-03],
        [0.0000e+00, 9.0086e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([2.9828e-02, 7.6321e-01, 3.0313e-04,  ..., 2.1603e-04, 3.8087e-03,
        9.0086e-03], grad_fn=<SelectBackward0>)
epoch: 8, train loss: 0.11947611719369888, test auc: 0.8799689239026325 test acc: 0.8292645478274221
X_example shape:  1599
Organization  0  contribution:  0.00070302
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00249954
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -324, 1: -324}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 2.6646e-02],
        [0.0000e+00, 8.4322e-01],
        [0.0000e+00, 3.2433e-04],
        ...,
        [0.0000e+00, 1.6773e-04],
        [0.0000e+00, 1.1692e-03],
        [0.0000e+00, 7.2269e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([2.6646e-02, 8.4322e-01, 3.2433e-04,  ..., 1.6773e-04, 1.1692e-03,
        7.2269e-03], grad_fn=<SelectBackward0>)
epoch: 9, train loss: 0.07534855604171753, test auc: 0.874611357882152 test acc: 0.8217411331183786
X_example shape:  1599
Organization  0  contribution:  0.00056218
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00298009
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -377, 1: -377}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 2.1631e-02],
        [0.0000e+00, 7.4602e-01],
        [0.0000e+00, 3.7702e-04],
        ...,
        [0.0000e+00, 1.9829e-04],
        [0.0000e+00, 1.9755e-03],
        [0.0000e+00, 1.0652e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([2.1631e-02, 7.4602e-01, 3.7702e-04,  ..., 1.9829e-04, 1.9755e-03,
        1.0652e-02], grad_fn=<SelectBackward0>)
epoch: 10, train loss: 0.10237795859575272, test auc: 0.8729759747583388 test acc: 0.8248119146322739
X_example shape:  1599
Organization  0  contribution:  0.00070333
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00236204
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -430, 1: -430}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 9.4485e-03],
        [0.0000e+00, 6.3992e-01],
        [0.0000e+00, 8.2147e-05],
        ...,
        [0.0000e+00, 4.6932e-05],
        [0.0000e+00, 4.9665e-04],
        [0.0000e+00, 4.0861e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([9.4485e-03, 6.3992e-01, 8.2147e-05,  ..., 4.6932e-05, 4.9665e-04,
        4.0861e-03], grad_fn=<SelectBackward0>)
epoch: 11, train loss: 0.11550974100828171, test auc: 0.8795583600148953 test acc: 0.8304928604329802
X_example shape:  1599
Organization  0  contribution:  0.00090085
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00224486
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -483, 1: -483}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 2.2376e-02],
        [0.0000e+00, 6.8386e-01],
        [0.0000e+00, 2.4261e-04],
        ...,
        [0.0000e+00, 1.1915e-04],
        [0.0000e+00, 9.3185e-04],
        [0.0000e+00, 8.3385e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([2.2376e-02, 6.8386e-01, 2.4261e-04,  ..., 1.1915e-04, 9.3185e-04,
        8.3385e-03], grad_fn=<SelectBackward0>)
epoch: 12, train loss: 0.189568892121315, test auc: 0.8739018434140385 test acc: 0.826040227237832
X_example shape:  1599
Organization  0  contribution:  0.00084508
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00236038
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -536, 1: -536}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 3.9029e-03],
        [0.0000e+00, 5.7526e-01],
        [0.0000e+00, 5.2028e-05],
        ...,
        [0.0000e+00, 4.0392e-05],
        [0.0000e+00, 1.4237e-04],
        [0.0000e+00, 3.5164e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([3.9029e-03, 5.7526e-01, 5.2028e-05,  ..., 4.0392e-05, 1.4237e-04,
        3.5164e-03], grad_fn=<SelectBackward0>)
epoch: 13, train loss: 0.05391702428460121, test auc: 0.8742027030019525 test acc: 0.8315676339628435
X_example shape:  1599
Organization  0  contribution:  0.00040421
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00244435
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -589, 1: -589}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 9.1956e-03],
        [0.0000e+00, 7.4372e-01],
        [0.0000e+00, 7.6656e-05],
        ...,
        [0.0000e+00, 4.0875e-05],
        [0.0000e+00, 4.5690e-04],
        [0.0000e+00, 5.0881e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([9.1956e-03, 7.4372e-01, 7.6656e-05,  ..., 4.0875e-05, 4.5690e-04,
        5.0881e-03], grad_fn=<SelectBackward0>)
epoch: 14, train loss: 0.09713981300592422, test auc: 0.8745385610613878 test acc: 0.8232765238753262
X_example shape:  1599
Organization  0  contribution:  0.00094588
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00246738
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -642, 1: -642}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.3523e-02],
        [0.0000e+00, 5.9150e-01],
        [0.0000e+00, 1.4042e-04],
        ...,
        [0.0000e+00, 4.0187e-05],
        [0.0000e+00, 3.0402e-04],
        [0.0000e+00, 2.8398e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.3523e-02, 5.9150e-01, 1.4042e-04,  ..., 4.0187e-05, 3.0402e-04,
        2.8398e-03], grad_fn=<SelectBackward0>)
epoch: 15, train loss: 0.10177939385175705, test auc: 0.8714635317199421 test acc: 0.8323353293413174
X_example shape:  1599
Organization  0  contribution:  -0.00015964
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00262338
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -695, 1: -695}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 2.6739e-02],
        [0.0000e+00, 6.9931e-01],
        [0.0000e+00, 5.3096e-04],
        ...,
        [0.0000e+00, 5.8642e-04],
        [0.0000e+00, 3.1868e-03],
        [0.0000e+00, 1.5258e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([2.6739e-02, 6.9931e-01, 5.3096e-04,  ..., 5.8642e-04, 3.1868e-03,
        1.5258e-02], grad_fn=<SelectBackward0>)
epoch: 16, train loss: 0.12315421551465988, test auc: 0.8726895599941253 test acc: 0.831874712114233
X_example shape:  1599
Organization  0  contribution:  0.00000717
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00235053
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -748, 1: -748}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 2.5326e-03],
        [0.0000e+00, 7.0781e-01],
        [0.0000e+00, 5.4395e-05],
        ...,
        [0.0000e+00, 5.1571e-06],
        [0.0000e+00, 2.1046e-04],
        [0.0000e+00, 1.0599e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([2.5326e-03, 7.0781e-01, 5.4395e-05,  ..., 5.1571e-06, 2.1046e-04,
        1.0599e-03], grad_fn=<SelectBackward0>)
epoch: 17, train loss: 0.030426329001784325, test auc: 0.8773311209208645 test acc: 0.8320282511899278
X_example shape:  1599
Organization  0  contribution:  0.00004678
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00300160
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -801, 1: -801}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 3.7591e-03],
        [0.0000e+00, 6.4139e-01],
        [0.0000e+00, 3.1294e-05],
        ...,
        [0.0000e+00, 1.3314e-05],
        [0.0000e+00, 9.5088e-05],
        [0.0000e+00, 2.1004e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([3.7591e-03, 6.4139e-01, 3.1294e-05,  ..., 1.3314e-05, 9.5088e-05,
        2.1004e-03], grad_fn=<SelectBackward0>)
epoch: 18, train loss: 0.032536473125219345, test auc: 0.871861114356424 test acc: 0.8326424074927069
X_example shape:  1599
Organization  0  contribution:  0.00000443
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00262330
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -854, 1: -854}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.3863e-02],
        [0.0000e+00, 5.2923e-01],
        [0.0000e+00, 8.0037e-05],
        ...,
        [0.0000e+00, 2.2666e-05],
        [0.0000e+00, 1.7038e-04],
        [0.0000e+00, 4.5048e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.3863e-02, 5.2923e-01, 8.0037e-05,  ..., 2.2666e-05, 1.7038e-04,
        4.5048e-03], grad_fn=<SelectBackward0>)
epoch: 19, train loss: 0.09551367908716202, test auc: 0.8684884071062933 test acc: 0.8243512974051896
X_example shape:  1599
Organization  0  contribution:  0.00022470
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00279241
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -907, 1: -907}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.0560e-02],
        [0.0000e+00, 5.1502e-01],
        [0.0000e+00, 5.8256e-05],
        ...,
        [0.0000e+00, 4.8222e-05],
        [0.0000e+00, 5.3233e-04],
        [0.0000e+00, 7.2148e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.0560e-02, 5.1502e-01, 5.8256e-05,  ..., 4.8222e-05, 5.3233e-04,
        7.2148e-03], grad_fn=<SelectBackward0>)
epoch: 20, train loss: 0.04302038252353668, test auc: 0.8756139686408604 test acc: 0.8366344234607708
X_example shape:  1599
Organization  0  contribution:  -0.00003054
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00230073
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -960, 1: -960}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 9.5381e-03],
        [0.0000e+00, 5.5066e-01],
        [0.0000e+00, 9.4918e-05],
        ...,
        [0.0000e+00, 4.7902e-05],
        [0.0000e+00, 2.9991e-04],
        [0.0000e+00, 4.9225e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([9.5381e-03, 5.5066e-01, 9.4918e-05,  ..., 4.7902e-05, 2.9991e-04,
        4.9225e-03], grad_fn=<SelectBackward0>)
epoch: 21, train loss: 0.03565817326307297, test auc: 0.8727819559589416 test acc: 0.8265008444649163
X_example shape:  1599
Organization  0  contribution:  -0.00019215
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00320590
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1013, 1: -1013}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 8.0957e-03],
        [0.0000e+00, 5.6537e-01],
        [0.0000e+00, 3.3473e-05],
        ...,
        [0.0000e+00, 1.8566e-05],
        [0.0000e+00, 7.1533e-05],
        [0.0000e+00, 3.2142e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([8.0957e-03, 5.6537e-01, 3.3473e-05,  ..., 1.8566e-05, 7.1533e-05,
        3.2142e-03], grad_fn=<SelectBackward0>)
epoch: 22, train loss: 0.037165991961956024, test auc: 0.8683505131284992 test acc: 0.8271150007676954
X_example shape:  1599
Organization  0  contribution:  -0.00003378
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00282735
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1066, 1: -1066}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 4.5572e-03],
        [0.0000e+00, 4.1521e-01],
        [0.0000e+00, 1.8559e-05],
        ...,
        [0.0000e+00, 1.5744e-05],
        [0.0000e+00, 9.2734e-05],
        [0.0000e+00, 3.6412e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([4.5572e-03, 4.1521e-01, 1.8559e-05,  ..., 1.5744e-05, 9.2734e-05,
        3.6412e-03], grad_fn=<SelectBackward0>)
epoch: 23, train loss: 0.07525037974119186, test auc: 0.8713131019259851 test acc: 0.8358667280822969
X_example shape:  1599
Organization  0  contribution:  -0.00075940
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00294483
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1119, 1: -1119}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 7.7321e-03],
        [0.0000e+00, 7.2673e-01],
        [0.0000e+00, 2.9682e-05],
        ...,
        [0.0000e+00, 2.5235e-05],
        [0.0000e+00, 2.1653e-04],
        [0.0000e+00, 2.6816e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([7.7321e-03, 7.2673e-01, 2.9682e-05,  ..., 2.5235e-05, 2.1653e-04,
        2.6816e-03], grad_fn=<SelectBackward0>)
epoch: 24, train loss: 0.09624870866537094, test auc: 0.8722776598011118 test acc: 0.8297251650545063
X_example shape:  1599
Organization  0  contribution:  -0.00045494
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00315506
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1172, 1: -1172}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.3095e-02],
        [0.0000e+00, 6.9299e-01],
        [0.0000e+00, 1.1159e-04],
        ...,
        [0.0000e+00, 8.4685e-05],
        [0.0000e+00, 5.4703e-04],
        [0.0000e+00, 5.4128e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.3095e-02, 6.9299e-01, 1.1159e-04,  ..., 8.4685e-05, 5.4703e-04,
        5.4128e-03], grad_fn=<SelectBackward0>)
epoch: 25, train loss: 0.03934289515018463, test auc: 0.8730462262357197 test acc: 0.8278826961461692
X_example shape:  1599
Organization  0  contribution:  -0.00020157
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00304685
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1225, 1: -1225}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 9.5072e-03],
        [0.0000e+00, 5.3764e-01],
        [0.0000e+00, 7.3920e-05],
        ...,
        [0.0000e+00, 6.8986e-05],
        [0.0000e+00, 3.4800e-04],
        [0.0000e+00, 4.6624e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([9.5072e-03, 5.3764e-01, 7.3920e-05,  ..., 6.8986e-05, 3.4800e-04,
        4.6624e-03], grad_fn=<SelectBackward0>)
epoch: 26, train loss: 0.03221173211932182, test auc: 0.8761965977413132 test acc: 0.8329494856440964
X_example shape:  1599
Organization  0  contribution:  -0.00011721
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00244496
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1278, 1: -1278}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.1349e-02],
        [0.0000e+00, 8.2521e-01],
        [0.0000e+00, 6.8284e-05],
        ...,
        [0.0000e+00, 5.5214e-05],
        [0.0000e+00, 2.3747e-04],
        [0.0000e+00, 3.8190e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.1349e-02, 8.2521e-01, 6.8284e-05,  ..., 5.5214e-05, 2.3747e-04,
        3.8190e-03], grad_fn=<SelectBackward0>)
epoch: 27, train loss: 0.067621611058712, test auc: 0.8750154311442615 test acc: 0.8284968524489482
X_example shape:  1599
Organization  0  contribution:  -0.00042233
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00320647
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1331, 1: -1331}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.5728e-02],
        [0.0000e+00, 7.1568e-01],
        [0.0000e+00, 1.0777e-04],
        ...,
        [0.0000e+00, 2.3307e-04],
        [0.0000e+00, 6.4847e-04],
        [0.0000e+00, 1.7263e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.5728e-02, 7.1568e-01, 1.0777e-04,  ..., 2.3307e-04, 6.4847e-04,
        1.7263e-02], grad_fn=<SelectBackward0>)
epoch: 28, train loss: 0.0244587454944849, test auc: 0.8689092796347332 test acc: 0.8288039306003377
X_example shape:  1599
Organization  0  contribution:  -0.00042831
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00287331
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1384, 1: -1384}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.1226e-02],
        [0.0000e+00, 6.4964e-01],
        [0.0000e+00, 7.0226e-05],
        ...,
        [0.0000e+00, 1.4092e-04],
        [0.0000e+00, 1.6254e-04],
        [0.0000e+00, 8.4370e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.1226e-02, 6.4964e-01, 7.0226e-05,  ..., 1.4092e-04, 1.6254e-04,
        8.4370e-03], grad_fn=<SelectBackward0>)
epoch: 29, train loss: 0.08455219119787216, test auc: 0.8645702327691072 test acc: 0.828650391524643
X_example shape:  1599
Organization  0  contribution:  -0.00010313
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00245859
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1437, 1: -1437}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 8.5419e-03],
        [0.0000e+00, 6.8432e-01],
        [0.0000e+00, 2.8035e-05],
        ...,
        [0.0000e+00, 2.9242e-05],
        [0.0000e+00, 1.4791e-04],
        [0.0000e+00, 2.8890e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([8.5419e-03, 6.8432e-01, 2.8035e-05,  ..., 2.9242e-05, 1.4791e-04,
        2.8890e-03], grad_fn=<SelectBackward0>)
epoch: 30, train loss: 0.08304376155138016, test auc: 0.8703928330257288 test acc: 0.8229694457239367
X_example shape:  1599
Organization  0  contribution:  0.00009368
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00292759
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1490, 1: -1490}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.1419e-02],
        [0.0000e+00, 8.2828e-01],
        [0.0000e+00, 1.0735e-04],
        ...,
        [0.0000e+00, 2.7950e-05],
        [0.0000e+00, 4.1936e-05],
        [0.0000e+00, 4.7675e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.1419e-02, 8.2828e-01, 1.0735e-04,  ..., 2.7950e-05, 4.1936e-05,
        4.7675e-03], grad_fn=<SelectBackward0>)
epoch: 31, train loss: 0.11804092675447464, test auc: 0.864302271744423 test acc: 0.8152924919391985
X_example shape:  1599
Organization  0  contribution:  -0.00013256
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00330944
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1543, 1: -1543}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 6.6800e-03],
        [0.0000e+00, 5.7601e-01],
        [0.0000e+00, 1.4822e-05],
        ...,
        [0.0000e+00, 2.5866e-05],
        [0.0000e+00, 1.1612e-04],
        [0.0000e+00, 2.7111e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([6.6800e-03, 5.7601e-01, 1.4822e-05,  ..., 2.5866e-05, 1.1612e-04,
        2.7111e-03], grad_fn=<SelectBackward0>)
epoch: 32, train loss: 0.03419339284300804, test auc: 0.8714302513552044 test acc: 0.8301857822815907
X_example shape:  1599
Organization  0  contribution:  -0.00074957
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00329730
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1596, 1: -1596}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 2.5863e-02],
        [0.0000e+00, 7.4488e-01],
        [0.0000e+00, 2.3219e-04],
        ...,
        [0.0000e+00, 5.3309e-04],
        [0.0000e+00, 1.3373e-03],
        [0.0000e+00, 1.9469e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([2.5863e-02, 7.4488e-01, 2.3219e-04,  ..., 5.3309e-04, 1.3373e-03,
        1.9469e-02], grad_fn=<SelectBackward0>)
epoch: 33, train loss: 0.1758355349302292, test auc: 0.8737347416209205 test acc: 0.8245048364808844
X_example shape:  1599
Organization  0  contribution:  -0.00063205
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00339501
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1649, 1: -1649}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 5.5222e-03],
        [0.0000e+00, 7.4219e-01],
        [0.0000e+00, 9.8425e-05],
        ...,
        [0.0000e+00, 3.8067e-05],
        [0.0000e+00, 2.1183e-04],
        [0.0000e+00, 3.0080e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([5.5222e-03, 7.4219e-01, 9.8425e-05,  ..., 3.8067e-05, 2.1183e-04,
        3.0080e-03], grad_fn=<SelectBackward0>)
epoch: 34, train loss: 0.03646330162882805, test auc: 0.871830188434316 test acc: 0.826654383540611
X_example shape:  1599
Organization  0  contribution:  -0.00035666
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00306075
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1702, 1: -1702}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 8.5158e-03],
        [0.0000e+00, 6.6917e-01],
        [0.0000e+00, 2.5088e-05],
        ...,
        [0.0000e+00, 6.8261e-05],
        [0.0000e+00, 9.9323e-05],
        [0.0000e+00, 6.1161e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([8.5158e-03, 6.6917e-01, 2.5088e-05,  ..., 6.8261e-05, 9.9323e-05,
        6.1161e-03], grad_fn=<SelectBackward0>)
epoch: 35, train loss: 0.053368598222732544, test auc: 0.8694421472720409 test acc: 0.8277291570704745
X_example shape:  1599
Organization  0  contribution:  0.00010265
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00255100
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1755, 1: -1755}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 5.1197e-03],
        [0.0000e+00, 7.2864e-01],
        [0.0000e+00, 1.4184e-05],
        ...,
        [0.0000e+00, 1.6025e-05],
        [0.0000e+00, 5.7628e-05],
        [0.0000e+00, 3.1508e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([5.1197e-03, 7.2864e-01, 1.4184e-05,  ..., 1.6025e-05, 5.7628e-05,
        3.1508e-03], grad_fn=<SelectBackward0>)
epoch: 36, train loss: 0.1098981499671936, test auc: 0.8715989439879371 test acc: 0.8298787041302012
X_example shape:  1599
Organization  0  contribution:  0.00014709
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00258024
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1808, 1: -1808}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.9423e-02],
        [0.0000e+00, 6.8755e-01],
        [0.0000e+00, 2.5232e-04],
        ...,
        [0.0000e+00, 3.1971e-04],
        [0.0000e+00, 6.6500e-04],
        [0.0000e+00, 1.4838e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.9423e-02, 6.8755e-01, 2.5232e-04,  ..., 3.1971e-04, 6.6500e-04,
        1.4838e-02], grad_fn=<SelectBackward0>)
epoch: 37, train loss: 0.04972738027572632, test auc: 0.8706077236408695 test acc: 0.8240442192538001
X_example shape:  1599
Organization  0  contribution:  0.00030444
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00257671
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1861, 1: -1861}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.0083e-02],
        [0.0000e+00, 7.5757e-01],
        [0.0000e+00, 1.7852e-05],
        ...,
        [0.0000e+00, 6.9556e-05],
        [0.0000e+00, 2.7673e-04],
        [0.0000e+00, 6.2662e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.0083e-02, 7.5757e-01, 1.7852e-05,  ..., 6.9556e-05, 2.7673e-04,
        6.2662e-03], grad_fn=<SelectBackward0>)
epoch: 38, train loss: 0.04211501404643059, test auc: 0.8706518217149861 test acc: 0.82081989866421
X_example shape:  1599
Organization  0  contribution:  0.00052957
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00243938
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1914, 1: -1914}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 7.3289e-03],
        [0.0000e+00, 6.0084e-01],
        [0.0000e+00, 6.7303e-05],
        ...,
        [0.0000e+00, 4.5076e-05],
        [0.0000e+00, 1.4406e-04],
        [0.0000e+00, 5.2539e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([7.3289e-03, 6.0084e-01, 6.7303e-05,  ..., 4.5076e-05, 1.4406e-04,
        5.2539e-03], grad_fn=<SelectBackward0>)
epoch: 39, train loss: 0.05006912350654602, test auc: 0.8678593254890941 test acc: 0.8327959465684016
X_example shape:  1599
Organization  0  contribution:  -0.00056665
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00281745
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -1967, 1: -1967}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.8642e-02],
        [0.0000e+00, 7.2355e-01],
        [0.0000e+00, 2.0875e-04],
        ...,
        [0.0000e+00, 3.0857e-04],
        [0.0000e+00, 5.8581e-04],
        [0.0000e+00, 1.3750e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.8642e-02, 7.2355e-01, 2.0875e-04,  ..., 3.0857e-04, 5.8581e-04,
        1.3750e-02], grad_fn=<SelectBackward0>)
epoch: 40, train loss: 0.0627845749258995, test auc: 0.8692378834655258 test acc: 0.8231229847996315
X_example shape:  1599
Organization  0  contribution:  0.00003071
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00286343
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2020, 1: -2020}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 4.5596e-03],
        [0.0000e+00, 6.3708e-01],
        [0.0000e+00, 7.6707e-05],
        ...,
        [0.0000e+00, 5.8400e-05],
        [0.0000e+00, 1.0212e-04],
        [0.0000e+00, 4.5625e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([4.5596e-03, 6.3708e-01, 7.6707e-05,  ..., 5.8400e-05, 1.0212e-04,
        4.5625e-03], grad_fn=<SelectBackward0>)
epoch: 41, train loss: 0.08093909174203873, test auc: 0.8647176081510041 test acc: 0.8281897742975587
X_example shape:  1599
Organization  0  contribution:  0.00025855
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00221906
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2073, 1: -2073}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 8.3974e-03],
        [0.0000e+00, 8.0842e-01],
        [0.0000e+00, 4.4992e-05],
        ...,
        [0.0000e+00, 5.2136e-05],
        [0.0000e+00, 2.0668e-04],
        [0.0000e+00, 4.4853e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([8.3974e-03, 8.0842e-01, 4.4992e-05,  ..., 5.2136e-05, 2.0668e-04,
        4.4853e-03], grad_fn=<SelectBackward0>)
epoch: 42, train loss: 0.08451206237077713, test auc: 0.8703783882020281 test acc: 0.8218946721940734
X_example shape:  1599
Organization  0  contribution:  0.00070497
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00242013
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2126, 1: -2126}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 6.0241e-03],
        [0.0000e+00, 6.6580e-01],
        [0.0000e+00, 2.0462e-05],
        ...,
        [0.0000e+00, 3.6646e-05],
        [0.0000e+00, 5.4689e-05],
        [0.0000e+00, 5.1325e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([6.0241e-03, 6.6580e-01, 2.0462e-05,  ..., 3.6646e-05, 5.4689e-05,
        5.1325e-03], grad_fn=<SelectBackward0>)
epoch: 43, train loss: 0.04042055830359459, test auc: 0.8660588132132847 test acc: 0.8274220789190849
X_example shape:  1599
Organization  0  contribution:  0.00042197
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00225138
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2179, 1: -2179}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.7248e-02],
        [0.0000e+00, 8.1865e-01],
        [0.0000e+00, 5.7878e-05],
        ...,
        [0.0000e+00, 1.7181e-04],
        [0.0000e+00, 6.4436e-04],
        [0.0000e+00, 9.7055e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.7248e-02, 8.1865e-01, 5.7878e-05,  ..., 1.7181e-04, 6.4436e-04,
        9.7055e-03], grad_fn=<SelectBackward0>)
epoch: 44, train loss: 0.09526479989290237, test auc: 0.8730319086791882 test acc: 0.8223552894211577
X_example shape:  1599
Organization  0  contribution:  0.00056654
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00232473
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2232, 1: -2232}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.3396e-02],
        [0.0000e+00, 6.1545e-01],
        [0.0000e+00, 3.8558e-05],
        ...,
        [0.0000e+00, 1.0250e-04],
        [0.0000e+00, 2.7246e-04],
        [0.0000e+00, 3.9261e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.3396e-02, 6.1545e-01, 3.8558e-05,  ..., 1.0250e-04, 2.7246e-04,
        3.9261e-03], grad_fn=<SelectBackward0>)
epoch: 45, train loss: 0.13129554688930511, test auc: 0.8688228652268677 test acc: 0.8309534776600644
X_example shape:  1599
Organization  0  contribution:  0.00026580
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00215557
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2285, 1: -2285}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 6.3229e-03],
        [0.0000e+00, 7.8401e-01],
        [0.0000e+00, 1.7075e-05],
        ...,
        [0.0000e+00, 4.3683e-05],
        [0.0000e+00, 5.2211e-05],
        [0.0000e+00, 5.6407e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([6.3229e-03, 7.8401e-01, 1.7075e-05,  ..., 4.3683e-05, 5.2211e-05,
        5.6407e-03], grad_fn=<SelectBackward0>)
epoch: 46, train loss: 0.006155841052532196, test auc: 0.8631096511021464 test acc: 0.8234300629510211
X_example shape:  1599
Organization  0  contribution:  0.00032026
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00246223
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2338, 1: -2338}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.4001e-02],
        [0.0000e+00, 7.6375e-01],
        [0.0000e+00, 1.3084e-04],
        ...,
        [0.0000e+00, 7.8484e-05],
        [0.0000e+00, 2.0882e-04],
        [0.0000e+00, 6.0848e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.4001e-02, 7.6375e-01, 1.3084e-04,  ..., 7.8484e-05, 2.0882e-04,
        6.0848e-03], grad_fn=<SelectBackward0>)
epoch: 47, train loss: 0.10931956022977829, test auc: 0.8675000502705319 test acc: 0.8231229847996315
X_example shape:  1599
Organization  0  contribution:  -0.00009016
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00300014
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2391, 1: -2391}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.1735e-02],
        [0.0000e+00, 7.3554e-01],
        [0.0000e+00, 8.4373e-06],
        ...,
        [0.0000e+00, 6.4741e-05],
        [0.0000e+00, 1.6485e-04],
        [0.0000e+00, 6.5573e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.1735e-02, 7.3554e-01, 8.4373e-06,  ..., 6.4741e-05, 1.6485e-04,
        6.5573e-03], grad_fn=<SelectBackward0>)
epoch: 48, train loss: 0.02891051210463047, test auc: 0.8698044132690786 test acc: 0.8271150007676954
X_example shape:  1599
Organization  0  contribution:  0.00014550
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00245733
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2444, 1: -2444}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.8609e-02],
        [0.0000e+00, 8.0195e-01],
        [0.0000e+00, 2.7751e-05],
        ...,
        [0.0000e+00, 1.0189e-04],
        [0.0000e+00, 2.4616e-04],
        [0.0000e+00, 9.9780e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.8609e-02, 8.0195e-01, 2.7751e-05,  ..., 1.0189e-04, 2.4616e-04,
        9.9780e-03], grad_fn=<SelectBackward0>)
epoch: 49, train loss: 0.04572261497378349, test auc: 0.8666435422220288 test acc: 0.8171349608475357
X_example shape:  1599
Organization  0  contribution:  -0.00020674
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00325354
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2497, 1: -2497}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 3.8238e-03],
        [0.0000e+00, 7.2521e-01],
        [0.0000e+00, 4.2863e-06],
        ...,
        [0.0000e+00, 1.9132e-05],
        [0.0000e+00, 3.6260e-05],
        [0.0000e+00, 2.0467e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([3.8238e-03, 7.2521e-01, 4.2863e-06,  ..., 1.9132e-05, 3.6260e-05,
        2.0467e-03], grad_fn=<SelectBackward0>)
epoch: 50, train loss: 0.10767679661512375, test auc: 0.8711388095378089 test acc: 0.8294180869031168
X_example shape:  1599
Organization  0  contribution:  -0.00014113
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00272696
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2550, 1: -2550}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.1423e-02],
        [0.0000e+00, 6.7978e-01],
        [0.0000e+00, 5.2767e-05],
        ...,
        [0.0000e+00, 2.6396e-04],
        [0.0000e+00, 1.3874e-04],
        [0.0000e+00, 1.3155e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.1423e-02, 6.7978e-01, 5.2767e-05,  ..., 2.6396e-04, 1.3874e-04,
        1.3155e-02], grad_fn=<SelectBackward0>)
epoch: 51, train loss: 0.026526635512709618, test auc: 0.8637639952524255 test acc: 0.8249654537079687
X_example shape:  1599
Organization  0  contribution:  -0.00092742
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00345016
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2603, 1: -2603}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.7386e-02],
        [0.0000e+00, 6.3251e-01],
        [0.0000e+00, 1.4445e-04],
        ...,
        [0.0000e+00, 3.8396e-04],
        [0.0000e+00, 4.9542e-04],
        [0.0000e+00, 1.3127e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.7386e-02, 6.3251e-01, 1.4445e-04,  ..., 3.8396e-04, 4.9542e-04,
        1.3127e-02], grad_fn=<SelectBackward0>)
epoch: 52, train loss: 0.09286931157112122, test auc: 0.8643050079885602 test acc: 0.8298787041302012
X_example shape:  1599
Organization  0  contribution:  -0.00073099
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00293058
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2656, 1: -2656}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 5.7260e-03],
        [0.0000e+00, 4.9384e-01],
        [0.0000e+00, 1.1942e-05],
        ...,
        [0.0000e+00, 1.5885e-04],
        [0.0000e+00, 1.4452e-04],
        [0.0000e+00, 8.8977e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([5.7260e-03, 4.9384e-01, 1.1942e-05,  ..., 1.5885e-04, 1.4452e-04,
        8.8977e-03], grad_fn=<SelectBackward0>)
epoch: 53, train loss: 0.08907318115234375, test auc: 0.8652591299558154 test acc: 0.8331030247197911
X_example shape:  1599
Organization  0  contribution:  -0.00061498
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00259568
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2709, 1: -2709}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 7.9442e-03],
        [0.0000e+00, 5.1343e-01],
        [0.0000e+00, 4.1799e-05],
        ...,
        [0.0000e+00, 7.1098e-05],
        [0.0000e+00, 1.1043e-04],
        [0.0000e+00, 4.5619e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([7.9442e-03, 5.1343e-01, 4.1799e-05,  ..., 7.1098e-05, 1.1043e-04,
        4.5619e-03], grad_fn=<SelectBackward0>)
epoch: 54, train loss: 0.03438818082213402, test auc: 0.8668005262751978 test acc: 0.833870720098265
X_example shape:  1599
Organization  0  contribution:  -0.00097432
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00317026
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2762, 1: -2762}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.1217e-02],
        [0.0000e+00, 6.3014e-01],
        [0.0000e+00, 2.1198e-05],
        ...,
        [0.0000e+00, 1.3439e-04],
        [0.0000e+00, 1.3950e-04],
        [0.0000e+00, 7.2513e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.1217e-02, 6.3014e-01, 2.1198e-05,  ..., 1.3439e-04, 1.3950e-04,
        7.2513e-03], grad_fn=<SelectBackward0>)
epoch: 55, train loss: 0.10890556126832962, test auc: 0.8646828642138209 test acc: 0.8321817902656226
X_example shape:  1599
Organization  0  contribution:  -0.00064901
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00272077
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2815, 1: -2815}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 5.1677e-03],
        [0.0000e+00, 7.8523e-01],
        [0.0000e+00, 1.0607e-05],
        ...,
        [0.0000e+00, 6.2566e-05],
        [0.0000e+00, 4.0528e-05],
        [0.0000e+00, 6.3594e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([5.1677e-03, 7.8523e-01, 1.0607e-05,  ..., 6.2566e-05, 4.0528e-05,
        6.3594e-03], grad_fn=<SelectBackward0>)
epoch: 56, train loss: 0.05661498010158539, test auc: 0.8606534583707818 test acc: 0.8205128205128205
X_example shape:  1599
Organization  0  contribution:  -0.00005085
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00272582
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2868, 1: -2868}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 2.4139e-03],
        [0.0000e+00, 7.5700e-01],
        [0.0000e+00, 1.3356e-05],
        ...,
        [0.0000e+00, 6.7876e-05],
        [0.0000e+00, 9.6516e-05],
        [0.0000e+00, 6.5296e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([2.4139e-03, 7.5700e-01, 1.3356e-05,  ..., 6.7876e-05, 9.6516e-05,
        6.5296e-03], grad_fn=<SelectBackward0>)
epoch: 57, train loss: 0.1338740438222885, test auc: 0.8671896456449303 test acc: 0.8212805158912944
X_example shape:  1599
Organization  0  contribution:  0.00018687
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00249058
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2921, 1: -2921}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 7.1987e-03],
        [0.0000e+00, 8.6030e-01],
        [0.0000e+00, 1.5606e-05],
        ...,
        [0.0000e+00, 1.7219e-04],
        [0.0000e+00, 5.4634e-04],
        [0.0000e+00, 1.4680e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([7.1987e-03, 8.6030e-01, 1.5606e-05,  ..., 1.7219e-04, 5.4634e-04,
        1.4680e-02], grad_fn=<SelectBackward0>)
epoch: 58, train loss: 0.06166456639766693, test auc: 0.8685183148910479 test acc: 0.8057730692461231
X_example shape:  1599
Organization  0  contribution:  0.00001042
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00312937
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -2974, 1: -2974}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 4.3445e-03],
        [0.0000e+00, 7.0847e-01],
        [0.0000e+00, 1.0805e-05],
        ...,
        [0.0000e+00, 9.3415e-05],
        [0.0000e+00, 1.1135e-04],
        [0.0000e+00, 9.4935e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([4.3445e-03, 7.0847e-01, 1.0805e-05,  ..., 9.3415e-05, 1.1135e-04,
        9.4935e-03], grad_fn=<SelectBackward0>)
epoch: 59, train loss: 0.08205848932266235, test auc: 0.8629163322721796 test acc: 0.82081989866421
X_example shape:  1599
Organization  0  contribution:  0.00047039
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00207072
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3027, 1: -3027}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.7825e-03],
        [0.0000e+00, 7.7167e-01],
        [0.0000e+00, 9.0565e-07],
        ...,
        [0.0000e+00, 1.6565e-05],
        [0.0000e+00, 2.5956e-05],
        [0.0000e+00, 4.4223e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.7825e-03, 7.7167e-01, 9.0565e-07,  ..., 1.6565e-05, 2.5956e-05,
        4.4223e-03], grad_fn=<SelectBackward0>)
epoch: 60, train loss: 0.1196509301662445, test auc: 0.8653181819223096 test acc: 0.8248119146322739
X_example shape:  1599
Organization  0  contribution:  0.00073372
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00185380
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3080, 1: -3080}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 2.7416e-03],
        [0.0000e+00, 7.1251e-01],
        [0.0000e+00, 8.1943e-06],
        ...,
        [0.0000e+00, 4.3911e-05],
        [0.0000e+00, 5.5895e-05],
        [0.0000e+00, 4.4175e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([2.7416e-03, 7.1251e-01, 8.1943e-06,  ..., 4.3911e-05, 5.5895e-05,
        4.4175e-03], grad_fn=<SelectBackward0>)
epoch: 61, train loss: 0.051187846809625626, test auc: 0.8625550207789108 test acc: 0.8269614616920006
X_example shape:  1599
Organization  0  contribution:  0.00061023
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00207611
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3133, 1: -3133}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 8.4824e-03],
        [0.0000e+00, 6.7078e-01],
        [0.0000e+00, 3.6611e-06],
        ...,
        [0.0000e+00, 8.8140e-05],
        [0.0000e+00, 4.3356e-05],
        [0.0000e+00, 7.4461e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([8.4824e-03, 6.7078e-01, 3.6611e-06,  ..., 8.8140e-05, 4.3356e-05,
        7.4461e-03], grad_fn=<SelectBackward0>)
epoch: 62, train loss: 0.07603505253791809, test auc: 0.8615169024800045 test acc: 0.8271150007676954
X_example shape:  1599
Organization  0  contribution:  -0.00100154
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00336059
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3186, 1: -3186}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.0425e-02],
        [0.0000e+00, 6.1200e-01],
        [0.0000e+00, 3.3111e-05],
        ...,
        [0.0000e+00, 1.9795e-04],
        [0.0000e+00, 1.2274e-04],
        [0.0000e+00, 1.0191e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.0425e-02, 6.1200e-01, 3.3111e-05,  ..., 1.9795e-04, 1.2274e-04,
        1.0191e-02], grad_fn=<SelectBackward0>)
epoch: 63, train loss: 0.0632382407784462, test auc: 0.8600421941572661 test acc: 0.8297251650545063
X_example shape:  1599
Organization  0  contribution:  -0.00113326
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00323402
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3239, 1: -3239}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.0493e-02],
        [0.0000e+00, 6.8275e-01],
        [0.0000e+00, 5.7865e-05],
        ...,
        [0.0000e+00, 1.4096e-04],
        [0.0000e+00, 1.5988e-04],
        [0.0000e+00, 9.1456e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.0493e-02, 6.8275e-01, 5.7865e-05,  ..., 1.4096e-04, 1.5988e-04,
        9.1456e-03], grad_fn=<SelectBackward0>)
epoch: 64, train loss: 0.020858915522694588, test auc: 0.860339235730105 test acc: 0.8257331490864425
X_example shape:  1599
Organization  0  contribution:  -0.00088243
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00334159
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3292, 1: -3292}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.3376e-02],
        [0.0000e+00, 7.6127e-01],
        [0.0000e+00, 7.4218e-06],
        ...,
        [0.0000e+00, 1.3990e-04],
        [0.0000e+00, 1.9193e-04],
        [0.0000e+00, 1.2104e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.3376e-02, 7.6127e-01, 7.4218e-06,  ..., 1.3990e-04, 1.9193e-04,
        1.2104e-02], grad_fn=<SelectBackward0>)
epoch: 65, train loss: 0.06231527402997017, test auc: 0.8665646365771444 test acc: 0.8220482112697681
X_example shape:  1599
Organization  0  contribution:  -0.00031395
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00304639
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3345, 1: -3345}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.1231e-02],
        [0.0000e+00, 6.8077e-01],
        [0.0000e+00, 3.0680e-05],
        ...,
        [0.0000e+00, 9.0364e-05],
        [0.0000e+00, 4.6347e-05],
        [0.0000e+00, 1.0947e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.1231e-02, 6.8077e-01, 3.0680e-05,  ..., 9.0364e-05, 4.6347e-05,
        1.0947e-02], grad_fn=<SelectBackward0>)
epoch: 66, train loss: 0.09104471653699875, test auc: 0.8589173432825715 test acc: 0.8261937663135268
X_example shape:  1599
Organization  0  contribution:  -0.00043558
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00282290
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3398, 1: -3398}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.0494e-02],
        [0.0000e+00, 7.5081e-01],
        [0.0000e+00, 4.0436e-06],
        ...,
        [0.0000e+00, 1.0500e-04],
        [0.0000e+00, 8.9150e-05],
        [0.0000e+00, 1.0103e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.0494e-02, 7.5081e-01, 4.0436e-06,  ..., 1.0500e-04, 8.9150e-05,
        1.0103e-02], grad_fn=<SelectBackward0>)
epoch: 67, train loss: 0.018239162862300873, test auc: 0.8633902752101625 test acc: 0.8243512974051896
X_example shape:  1599
Organization  0  contribution:  -0.00023841
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00280296
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3451, 1: -3451}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 8.2689e-03],
        [0.0000e+00, 7.7454e-01],
        [0.0000e+00, 6.9926e-06],
        ...,
        [0.0000e+00, 7.1996e-05],
        [0.0000e+00, 1.0439e-04],
        [0.0000e+00, 9.7113e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([8.2689e-03, 7.7454e-01, 6.9926e-06,  ..., 7.1996e-05, 1.0439e-04,
        9.7113e-03], grad_fn=<SelectBackward0>)
epoch: 68, train loss: 0.034972310066223145, test auc: 0.862455370585452 test acc: 0.8200522032857362
X_example shape:  1599
Organization  0  contribution:  -0.00033821
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00303596
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3504, 1: -3504}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 7.7823e-03],
        [0.0000e+00, 6.7342e-01],
        [0.0000e+00, 1.6179e-05],
        ...,
        [0.0000e+00, 9.2725e-05],
        [0.0000e+00, 8.2725e-05],
        [0.0000e+00, 6.6760e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([7.7823e-03, 6.7342e-01, 1.6179e-05,  ..., 9.2725e-05, 8.2725e-05,
        6.6760e-03], grad_fn=<SelectBackward0>)
epoch: 69, train loss: 0.02668403834104538, test auc: 0.8610019158799648 test acc: 0.826654383540611
X_example shape:  1599
Organization  0  contribution:  -0.00025735
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00267223
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3557, 1: -3557}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.8480e-03],
        [0.0000e+00, 8.8116e-01],
        [0.0000e+00, 2.7301e-06],
        ...,
        [0.0000e+00, 6.8353e-06],
        [0.0000e+00, 1.1067e-05],
        [0.0000e+00, 1.3749e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.8480e-03, 8.8116e-01, 2.7301e-06,  ..., 6.8353e-06, 1.1067e-05,
        1.3749e-03], grad_fn=<SelectBackward0>)
epoch: 70, train loss: 0.08176833391189575, test auc: 0.8652592572229845 test acc: 0.8192845079072624
X_example shape:  1599
Organization  0  contribution:  -0.00008008
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00305765
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3610, 1: -3610}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 8.4550e-03],
        [0.0000e+00, 8.4428e-01],
        [0.0000e+00, 9.6863e-06],
        ...,
        [0.0000e+00, 8.2814e-05],
        [0.0000e+00, 8.2196e-05],
        [0.0000e+00, 8.6087e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([8.4550e-03, 8.4428e-01, 9.6863e-06,  ..., 8.2814e-05, 8.2196e-05,
        8.6087e-03], grad_fn=<SelectBackward0>)
epoch: 71, train loss: 0.08907701820135117, test auc: 0.8607597264570374 test acc: 0.8225088284968525
X_example shape:  1599
Organization  0  contribution:  -0.00037601
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00303752
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3663, 1: -3663}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 3.1259e-03],
        [0.0000e+00, 8.1193e-01],
        [0.0000e+00, 9.4679e-07],
        ...,
        [0.0000e+00, 1.8482e-05],
        [0.0000e+00, 1.6967e-05],
        [0.0000e+00, 2.8657e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([3.1259e-03, 8.1193e-01, 9.4679e-07,  ..., 1.8482e-05, 1.6967e-05,
        2.8657e-03], grad_fn=<SelectBackward0>)
epoch: 72, train loss: 0.09110977500677109, test auc: 0.8630884611184799 test acc: 0.8271150007676954
X_example shape:  1599
Organization  0  contribution:  -0.00042389
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00290499
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3716, 1: -3716}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.2887e-02],
        [0.0000e+00, 7.2437e-01],
        [0.0000e+00, 1.4439e-05],
        ...,
        [0.0000e+00, 2.4382e-04],
        [0.0000e+00, 1.5118e-04],
        [0.0000e+00, 1.0874e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.2887e-02, 7.2437e-01, 1.4439e-05,  ..., 2.4382e-04, 1.5118e-04,
        1.0874e-02], grad_fn=<SelectBackward0>)
epoch: 73, train loss: 0.14565320312976837, test auc: 0.8617879179167485 test acc: 0.8243512974051896
X_example shape:  1599
Organization  0  contribution:  -0.00004766
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00255188
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3769, 1: -3769}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 6.0576e-03],
        [0.0000e+00, 7.6889e-01],
        [0.0000e+00, 7.3253e-06],
        ...,
        [0.0000e+00, 8.0549e-05],
        [0.0000e+00, 4.2940e-05],
        [0.0000e+00, 6.1323e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([6.0576e-03, 7.6889e-01, 7.3253e-06,  ..., 8.0549e-05, 4.2940e-05,
        6.1323e-03], grad_fn=<SelectBackward0>)
epoch: 74, train loss: 0.17204464972019196, test auc: 0.8584539635196295 test acc: 0.8254260709350529
X_example shape:  1599
Organization  0  contribution:  -0.00031886
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00283219
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3822, 1: -3822}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 5.8334e-03],
        [0.0000e+00, 7.4278e-01],
        [0.0000e+00, 5.9190e-06],
        ...,
        [0.0000e+00, 5.0333e-05],
        [0.0000e+00, 3.7417e-05],
        [0.0000e+00, 4.2144e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([5.8334e-03, 7.4278e-01, 5.9190e-06,  ..., 5.0333e-05, 3.7417e-05,
        4.2144e-03], grad_fn=<SelectBackward0>)
epoch: 75, train loss: 0.025681769475340843, test auc: 0.8604248865349553 test acc: 0.8269614616920006
X_example shape:  1599
Organization  0  contribution:  -0.00025777
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00263047
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3875, 1: -3875}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.4406e-02],
        [0.0000e+00, 7.5944e-01],
        [0.0000e+00, 5.9264e-06],
        ...,
        [0.0000e+00, 2.0516e-04],
        [0.0000e+00, 1.2529e-04],
        [0.0000e+00, 1.1832e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.4406e-02, 7.5944e-01, 5.9264e-06,  ..., 2.0516e-04, 1.2529e-04,
        1.1832e-02], grad_fn=<SelectBackward0>)
epoch: 76, train loss: 0.04387585446238518, test auc: 0.8643052625228985 test acc: 0.8166743436204514
X_example shape:  1599
Organization  0  contribution:  -0.00020922
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00298687
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3928, 1: -3928}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 4.2873e-03],
        [0.0000e+00, 6.6711e-01],
        [0.0000e+00, 6.7984e-06],
        ...,
        [0.0000e+00, 2.7440e-05],
        [0.0000e+00, 2.0333e-05],
        [0.0000e+00, 3.7786e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([4.2873e-03, 6.6711e-01, 6.7984e-06,  ..., 2.7440e-05, 2.0333e-05,
        3.7786e-03], grad_fn=<SelectBackward0>)
epoch: 77, train loss: 0.012976507656276226, test auc: 0.8579275228743647 test acc: 0.8254260709350529
X_example shape:  1599
Organization  0  contribution:  -0.00052798
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00284093
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -3981, 1: -3981}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 7.0685e-03],
        [0.0000e+00, 6.2198e-01],
        [0.0000e+00, 7.7935e-06],
        ...,
        [0.0000e+00, 8.2791e-05],
        [0.0000e+00, 3.3760e-05],
        [0.0000e+00, 5.8628e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([7.0685e-03, 6.2198e-01, 7.7935e-06,  ..., 8.2791e-05, 3.3760e-05,
        5.8628e-03], grad_fn=<SelectBackward0>)
epoch: 78, train loss: 0.022098595276474953, test auc: 0.8574379897081584 test acc: 0.8294180869031168
X_example shape:  1599
Organization  0  contribution:  -0.00022878
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00242510
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4034, 1: -4034}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 2.7336e-02],
        [0.0000e+00, 7.8346e-01],
        [0.0000e+00, 3.7598e-05],
        ...,
        [0.0000e+00, 5.0424e-04],
        [0.0000e+00, 3.9549e-04],
        [0.0000e+00, 2.6114e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([2.7336e-02, 7.8346e-01, 3.7598e-05,  ..., 5.0424e-04, 3.9549e-04,
        2.6114e-02], grad_fn=<SelectBackward0>)
epoch: 79, train loss: 0.2689904272556305, test auc: 0.8624147087249026 test acc: 0.8125287885766928
X_example shape:  1599
Organization  0  contribution:  0.00006738
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00277749
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4087, 1: -4087}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 7.0832e-03],
        [0.0000e+00, 6.3255e-01],
        [0.0000e+00, 3.1084e-05],
        ...,
        [0.0000e+00, 7.3981e-05],
        [0.0000e+00, 4.0468e-05],
        [0.0000e+00, 6.7692e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([7.0832e-03, 6.3255e-01, 3.1084e-05,  ..., 7.3981e-05, 4.0468e-05,
        6.7692e-03], grad_fn=<SelectBackward0>)
epoch: 80, train loss: 0.018399374559521675, test auc: 0.8569319118099606 test acc: 0.8194380469829572
X_example shape:  1599
Organization  0  contribution:  -0.00034174
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00303967
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4140, 1: -4140}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 9.1151e-03],
        [0.0000e+00, 6.5006e-01],
        [0.0000e+00, 2.3401e-05],
        ...,
        [0.0000e+00, 2.0614e-04],
        [0.0000e+00, 6.0930e-05],
        [0.0000e+00, 1.0795e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([9.1151e-03, 6.5006e-01, 2.3401e-05,  ..., 2.0614e-04, 6.0930e-05,
        1.0795e-02], grad_fn=<SelectBackward0>)
epoch: 81, train loss: 0.15840475261211395, test auc: 0.8548064228176799 test acc: 0.8234300629510211
X_example shape:  1599
Organization  0  contribution:  -0.00050858
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00304245
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4193, 1: -4193}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.1934e-02],
        [0.0000e+00, 7.7937e-01],
        [0.0000e+00, 8.7608e-06],
        ...,
        [0.0000e+00, 1.0050e-04],
        [0.0000e+00, 5.4082e-05],
        [0.0000e+00, 9.1897e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.1934e-02, 7.7937e-01, 8.7608e-06,  ..., 1.0050e-04, 5.4082e-05,
        9.1897e-03], grad_fn=<SelectBackward0>)
epoch: 82, train loss: 0.07661013305187225, test auc: 0.8579910291917796 test acc: 0.8146783356364194
X_example shape:  1599
Organization  0  contribution:  -0.00031016
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00319101
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4246, 1: -4246}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 6.8974e-03],
        [0.0000e+00, 7.5602e-01],
        [0.0000e+00, 3.2959e-06],
        ...,
        [0.0000e+00, 8.0369e-05],
        [0.0000e+00, 6.0082e-05],
        [0.0000e+00, 6.6054e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([6.8974e-03, 7.5602e-01, 3.2959e-06,  ..., 8.0369e-05, 6.0082e-05,
        6.6054e-03], grad_fn=<SelectBackward0>)
epoch: 83, train loss: 0.056342627853155136, test auc: 0.8588802449027589 test acc: 0.8192845079072624
X_example shape:  1599
Organization  0  contribution:  -0.00025179
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00291439
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4299, 1: -4299}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.0661e-02],
        [0.0000e+00, 7.7123e-01],
        [0.0000e+00, 6.8187e-06],
        ...,
        [0.0000e+00, 1.5294e-04],
        [0.0000e+00, 1.2504e-04],
        [0.0000e+00, 1.5501e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.0661e-02, 7.7123e-01, 6.8187e-06,  ..., 1.5294e-04, 1.2504e-04,
        1.5501e-02], grad_fn=<SelectBackward0>)
epoch: 84, train loss: 0.06558478623628616, test auc: 0.8625761471289927 test acc: 0.8116075541225242
X_example shape:  1599
Organization  0  contribution:  -0.00025755
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00317536
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4352, 1: -4352}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 5.7320e-03],
        [0.0000e+00, 7.8678e-01],
        [0.0000e+00, 1.3263e-05],
        ...,
        [0.0000e+00, 5.6077e-05],
        [0.0000e+00, 2.6718e-05],
        [0.0000e+00, 7.6592e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([5.7320e-03, 7.8678e-01, 1.3263e-05,  ..., 5.6077e-05, 2.6718e-05,
        7.6592e-03], grad_fn=<SelectBackward0>)
epoch: 85, train loss: 0.014984119683504105, test auc: 0.8561018753326446 test acc: 0.8191309688315677
X_example shape:  1599
Organization  0  contribution:  -0.00026190
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00304125
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4405, 1: -4405}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.6684e-02],
        [0.0000e+00, 8.1990e-01],
        [0.0000e+00, 2.6840e-05],
        ...,
        [0.0000e+00, 4.6894e-04],
        [0.0000e+00, 2.2671e-04],
        [0.0000e+00, 2.1606e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.6684e-02, 8.1990e-01, 2.6840e-05,  ..., 4.6894e-04, 2.2671e-04,
        2.1606e-02], grad_fn=<SelectBackward0>)
epoch: 86, train loss: 0.064163438975811, test auc: 0.8588561277742015 test acc: 0.8114540150468295
X_example shape:  1599
Organization  0  contribution:  -0.00009479
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00302755
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4458, 1: -4458}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 9.0417e-03],
        [0.0000e+00, 7.0654e-01],
        [0.0000e+00, 8.6990e-06],
        ...,
        [0.0000e+00, 1.2308e-04],
        [0.0000e+00, 5.7450e-05],
        [0.0000e+00, 8.3544e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([9.0417e-03, 7.0654e-01, 8.6990e-06,  ..., 1.2308e-04, 5.7450e-05,
        8.3544e-03], grad_fn=<SelectBackward0>)
epoch: 87, train loss: 0.007745702285319567, test auc: 0.8565963082848637 test acc: 0.8206663595885153
X_example shape:  1599
Organization  0  contribution:  -0.00000897
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00271346
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4511, 1: -4511}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 9.1886e-03],
        [0.0000e+00, 7.0950e-01],
        [0.0000e+00, 1.1536e-05],
        ...,
        [0.0000e+00, 1.0935e-04],
        [0.0000e+00, 5.0513e-05],
        [0.0000e+00, 8.0016e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([9.1886e-03, 7.0950e-01, 1.1536e-05,  ..., 1.0935e-04, 5.0513e-05,
        8.0016e-03], grad_fn=<SelectBackward0>)
epoch: 88, train loss: 0.06777683645486832, test auc: 0.856651033167606 test acc: 0.82081989866421
X_example shape:  1599
Organization  0  contribution:  -0.00013602
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00264526
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4564, 1: -4564}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 4.4530e-03],
        [0.0000e+00, 6.4996e-01],
        [0.0000e+00, 5.3480e-06],
        ...,
        [0.0000e+00, 5.9476e-05],
        [0.0000e+00, 1.6891e-05],
        [0.0000e+00, 3.9662e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([4.4530e-03, 6.4996e-01, 5.3480e-06,  ..., 5.9476e-05, 1.6891e-05,
        3.9662e-03], grad_fn=<SelectBackward0>)
epoch: 89, train loss: 0.08037620782852173, test auc: 0.8559279011123915 test acc: 0.8257331490864425
X_example shape:  1599
Organization  0  contribution:  -0.00019117
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00256693
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4617, 1: -4617}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.0082e-02],
        [0.0000e+00, 6.8217e-01],
        [0.0000e+00, 6.4905e-05],
        ...,
        [0.0000e+00, 2.6912e-04],
        [0.0000e+00, 1.0785e-04],
        [0.0000e+00, 1.0919e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.0082e-02, 6.8217e-01, 6.4905e-05,  ..., 2.6912e-04, 1.0785e-04,
        1.0919e-02], grad_fn=<SelectBackward0>)
epoch: 90, train loss: 0.08667805045843124, test auc: 0.8551124367259453 test acc: 0.8255796100107478
X_example shape:  1599
Organization  0  contribution:  -0.00021610
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00259040
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4670, 1: -4670}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 6.4043e-03],
        [0.0000e+00, 6.4713e-01],
        [0.0000e+00, 2.4733e-05],
        ...,
        [0.0000e+00, 1.1304e-04],
        [0.0000e+00, 2.7226e-05],
        [0.0000e+00, 8.5801e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([6.4043e-03, 6.4713e-01, 2.4733e-05,  ..., 1.1304e-04, 2.7226e-05,
        8.5801e-03], grad_fn=<SelectBackward0>)
epoch: 91, train loss: 0.14937062561511993, test auc: 0.8511873263280393 test acc: 0.8232765238753262
X_example shape:  1599
Organization  0  contribution:  -0.00000225
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00221027
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4723, 1: -4723}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.2118e-02],
        [0.0000e+00, 6.9233e-01],
        [0.0000e+00, 2.0467e-05],
        ...,
        [0.0000e+00, 2.4730e-04],
        [0.0000e+00, 7.3512e-05],
        [0.0000e+00, 1.3710e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.2118e-02, 6.9233e-01, 2.0467e-05,  ..., 2.4730e-04, 7.3512e-05,
        1.3710e-02], grad_fn=<SelectBackward0>)
epoch: 92, train loss: 0.06870502233505249, test auc: 0.8529513129262972 test acc: 0.8217411331183786
X_example shape:  1599
Organization  0  contribution:  -0.00006712
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00262987
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4776, 1: -4776}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.2808e-02],
        [0.0000e+00, 8.3789e-01],
        [0.0000e+00, 2.0955e-06],
        ...,
        [0.0000e+00, 2.5758e-04],
        [0.0000e+00, 1.3242e-04],
        [0.0000e+00, 1.6257e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.2808e-02, 8.3789e-01, 2.0955e-06,  ..., 2.5758e-04, 1.3242e-04,
        1.6257e-02], grad_fn=<SelectBackward0>)
epoch: 93, train loss: 0.014139662496745586, test auc: 0.858611202107137 test acc: 0.8063872255489022
X_example shape:  1599
Organization  0  contribution:  -0.00000457
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00290769
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4829, 1: -4829}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.2965e-02],
        [0.0000e+00, 7.3146e-01],
        [0.0000e+00, 1.0535e-05],
        ...,
        [0.0000e+00, 2.3483e-04],
        [0.0000e+00, 6.8169e-05],
        [0.0000e+00, 1.4193e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.2965e-02, 7.3146e-01, 1.0535e-05,  ..., 2.3483e-04, 6.8169e-05,
        1.4193e-02], grad_fn=<SelectBackward0>)
epoch: 94, train loss: 0.0528784804046154, test auc: 0.8534269103374795 test acc: 0.8200522032857362
X_example shape:  1599
Organization  0  contribution:  -0.00006058
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00264498
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4882, 1: -4882}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 2.6568e-03],
        [0.0000e+00, 5.3662e-01],
        [0.0000e+00, 2.6765e-06],
        ...,
        [0.0000e+00, 3.8718e-05],
        [0.0000e+00, 1.0667e-05],
        [0.0000e+00, 3.4239e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([2.6568e-03, 5.3662e-01, 2.6765e-06,  ..., 3.8718e-05, 1.0667e-05,
        3.4239e-03], grad_fn=<SelectBackward0>)
epoch: 95, train loss: 0.02623978815972805, test auc: 0.8562720315378227 test acc: 0.8249654537079687
X_example shape:  1599
Organization  0  contribution:  -0.00020829
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00256997
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4935, 1: -4935}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.5724e-02],
        [0.0000e+00, 6.5009e-01],
        [0.0000e+00, 6.0317e-06],
        ...,
        [0.0000e+00, 2.6575e-04],
        [0.0000e+00, 1.4322e-04],
        [0.0000e+00, 1.5551e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.5724e-02, 6.5009e-01, 6.0317e-06,  ..., 2.6575e-04, 1.4322e-04,
        1.5551e-02], grad_fn=<SelectBackward0>)
epoch: 96, train loss: 0.25889262557029724, test auc: 0.8559763899038445 test acc: 0.8231229847996315
X_example shape:  1599
Organization  0  contribution:  0.00018778
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00212544
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -4988, 1: -4988}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 1.0367e-02],
        [0.0000e+00, 5.1039e-01],
        [0.0000e+00, 5.4319e-05],
        ...,
        [0.0000e+00, 3.0169e-04],
        [0.0000e+00, 1.0204e-04],
        [0.0000e+00, 1.4398e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([1.0367e-02, 5.1039e-01, 5.4319e-05,  ..., 3.0169e-04, 1.0204e-04,
        1.4398e-02], grad_fn=<SelectBackward0>)
epoch: 97, train loss: 0.1667519062757492, test auc: 0.8530704986302233 test acc: 0.8252725318593582
X_example shape:  1599
Organization  0  contribution:  -0.00001836
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00235908
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -5041, 1: -5041}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 4.8895e-03],
        [0.0000e+00, 6.7804e-01],
        [0.0000e+00, 1.7132e-06],
        ...,
        [0.0000e+00, 3.4610e-05],
        [0.0000e+00, 1.0876e-05],
        [0.0000e+00, 5.7335e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([4.8895e-03, 6.7804e-01, 1.7132e-06,  ..., 3.4610e-05, 1.0876e-05,
        5.7335e-03], grad_fn=<SelectBackward0>)
epoch: 98, train loss: 0.05619606375694275, test auc: 0.8543103353922616 test acc: 0.8162137263933671
X_example shape:  1599
Organization  0  contribution:  -0.00013030
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00294396
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -5094, 1: -5094}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 6.1599e-03],
        [0.0000e+00, 7.4495e-01],
        [0.0000e+00, 6.3012e-06],
        ...,
        [0.0000e+00, 7.2179e-05],
        [0.0000e+00, 1.9668e-05],
        [0.0000e+00, 6.4119e-03]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([6.1599e-03, 7.4495e-01, 6.3012e-06,  ..., 7.2179e-05, 1.9668e-05,
        6.4119e-03], grad_fn=<SelectBackward0>)
epoch: 99, train loss: 0.03308918699622154, test auc: 0.8531629582286243 test acc: 0.81759557807462
X_example shape:  1599
Organization  0  contribution:  -0.00023145
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00281188
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -5147, 1: -5147}
organization_outputs_for_test_cat shape:  torch.Size([6513, 128])
outputs shape:  torch.Size([6513, 2])
outputs:  tensor([[0.0000e+00, 3.4078e-02],
        [0.0000e+00, 6.8489e-01],
        [0.0000e+00, 2.9453e-05],
        ...,
        [0.0000e+00, 8.4653e-04],
        [0.0000e+00, 3.3673e-04],
        [0.0000e+00, 3.4606e-02]], grad_fn=<CatBackward0>)
y_test shape:  torch.Size([6513])
y_test:  tensor([0., 1., 0.,  ..., 0., 1., 0.])
log_probs shape:  torch.Size([6513])
log_probs:  tensor([3.4078e-02, 6.8489e-01, 2.9453e-05,  ..., 8.4653e-04, 3.3673e-04,
        3.4606e-02], grad_fn=<SelectBackward0>)
epoch: 100, train loss: 0.12875570356845856, test auc: 0.8524253813497091 test acc: 0.8116075541225242
X_example shape:  1599
Organization  0  contribution:  -0.00008732
HERE:  <class 'list'> <class 'torch.Tensor'>
Organization  1  contribution:  0.00272507
HERE:  <class 'list'> <class 'torch.Tensor'>
sorted_organizations:  [0 1]
tokens per organization:  {0: -5200, 1: -5200}
attributions across epochs:  [[0.00279764246559333, -0.0007834352431018702], [0.003198517666643338, 0.0009200691803506081], [0.0017128368471261098, 0.0013386554078310688], [0.0013138072340679193, 0.0013145965716554347], [0.0010013162832578767, 0.0021907374905971062], [0.0009156501692165191, 0.0021440128336103724], [0.0006017230417404019, 0.001807717098343471], [0.0007030169296554528, 0.002499543938607332], [0.000562183416530436, 0.002980094268281676], [0.0007033261424435231, 0.0023620430294383774], [0.0009008478095340224, 0.002244862249937028], [0.0008450828259741742, 0.0023603832230643658], [0.00040420704345994925, 0.0024443453017958566], [0.0009458835769142596, 0.00246737847645852], [-0.00015964226159286842, 0.0026233760082716106], [7.174835649499053e-06, 0.00235052930772302], [4.677607365989862e-05, 0.003001604500070989], [4.433056920389849e-06, 0.00262329838105056], [0.00022470420621588982, 0.0027924131323016645], [-3.053981708472257e-05, 0.002300733494266735], [-0.00019214529438980692, 0.0032058971859768594], [-3.378295870454997e-05, 0.002827349749402874], [-0.0007593978130842139, 0.0029448293686765293], [-0.00045494090371707397, 0.003155059468912349], [-0.00020157225373098096, 0.003046850105719716], [-0.00011721299555690051, 0.0024449561506970584], [-0.0004223328506758577, 0.003206465009412057], [-0.00042830707116286093, 0.0028733111284934814], [-0.00010313049206021087, 0.0024585918619836784], [9.367653831149254e-05, 0.0029275899446406495], [-0.00013256482946824707, 0.003309439199246094], [-0.0007495653651063673, 0.003297299998004731], [-0.0006320498931027212, 0.0033950065216845856], [-0.0003566555799302733, 0.0030607500485351465], [0.00010265334875784875, 0.002550998332731451], [0.00014708832732953386, 0.0025802351376041726], [0.0003044420519731633, 0.0025767066623536964], [0.0005295684004316043, 0.0024393837937825512], [-0.0005666501254665892, 0.002817448739726159], [3.071461854372176e-05, 0.002863432927856854], [0.00025855014999563876, 0.002219057086392072], [0.0007049706439260667, 0.0024201252808132923], [0.0004219708725749439, 0.0022513757891323965], [0.000566538829944501, 0.0023247306494226204], [0.00026579983921845536, 0.002155571960032424], [0.0003202554280624586, 0.0024622265128604356], [-9.016145981850478e-05, 0.0030001408053129445], [0.00014549757805872333, 0.002457326490539305], [-0.00020673756930051805, 0.0032535437838323474], [-0.00014113056105802938, 0.0027269571006441613], [-0.0009274179132415866, 0.003450160604157539], [-0.0007309946761445218, 0.0029305771118453465], [-0.0006149797027702164, 0.0025956784582429676], [-0.0009743175178492001, 0.00317025607207307], [-0.0006490095264828621, 0.0027207731524997664], [-5.085005991550236e-05, 0.0027258240184498874], [0.0001868693969793526, 0.002490577205924641], [1.0420211501258309e-05, 0.0031293681235085137], [0.00047039173582797024, 0.002070724862956549], [0.0007337183779958164, 0.0018538037216271695], [0.000610232623110491, 0.002076113834905173], [-0.0010015361980210409, 0.003360587873816042], [-0.0011332629122679087, 0.0032340183934055113], [-0.0008824283098791804, 0.00334158679397361], [-0.0003139507333985581, 0.0030463911020562843], [-0.00043558435553565786, 0.002822900003413135], [-0.00023841290194381526, 0.002802960019325552], [-0.00033821444966370887, 0.003035960591304647], [-0.00025734815019171916, 0.0026722298550775248], [-8.008350426958187e-05, 0.0030576454858362973], [-0.00037600825136121656, 0.003037519462263108], [-0.00042389243903787164, 0.0029049870963507463], [-4.765713135261956e-05, 0.002551881558385551], [-0.00031886445611174346, 0.0028321918323144404], [-0.0002577712761129191, 0.002630470120427994], [-0.0002092211310380197, 0.0029868670892150024], [-0.0005279827453402476, 0.0028409320979483356], [-0.00022877854641501272, 0.002425104764776708], [6.738285244612745e-05, 0.0027774904397727205], [-0.00034174010826227934, 0.0030396718026199187], [-0.0005085843152598574, 0.0030424526753194537], [-0.0003101611827563004, 0.0031910090961014353], [-0.0002517936001320135, 0.002914389701671933], [-0.0002575505282772682, 0.0031753642844385204], [-0.0002618956905100169, 0.0030412460814910917], [-9.47896981864333e-05, 0.0030275455521960987], [-8.971886716477638e-06, 0.0027134611040843777], [-0.0001360225238009266, 0.002645257241271644], [-0.00019117013213236004, 0.0025669254608179353], [-0.0002161009684104196, 0.0025903977311173905], [-2.2537938165064723e-06, 0.002210265724095794], [-6.711834329762446e-05, 0.0026298710309927958], [-4.574534027771067e-06, 0.0029076924098435162], [-6.0579294714285125e-05, 0.0026449779188206907], [-0.00020829250726512758, 0.0025699681317919404], [0.00018777981542285964, 0.0021254369814368993], [-1.8364608706091573e-05, 0.0023590822851931315], [-0.00013030383333719484, 0.0029439624742908267], [-0.00023144623022751208, 0.00281187939957143], [-8.73222248349999e-05, 0.0027250722544699202]]
Elapsed time: 0:10:10
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100]
[array(0.24016905, dtype=float32), array(0.2649679, dtype=float32), array(0.10455417, dtype=float32), array(0.3333446, dtype=float32), array(0.16490719, dtype=float32), array(0.25297916, dtype=float32), array(0.11936554, dtype=float32), array(0.11947612, dtype=float32), array(0.07534856, dtype=float32), array(0.10237796, dtype=float32), array(0.11550974, dtype=float32), array(0.18956889, dtype=float32), array(0.05391702, dtype=float32), array(0.09713981, dtype=float32), array(0.10177939, dtype=float32), array(0.12315422, dtype=float32), array(0.03042633, dtype=float32), array(0.03253647, dtype=float32), array(0.09551368, dtype=float32), array(0.04302038, dtype=float32), array(0.03565817, dtype=float32), array(0.03716599, dtype=float32), array(0.07525038, dtype=float32), array(0.09624871, dtype=float32), array(0.0393429, dtype=float32), array(0.03221173, dtype=float32), array(0.06762161, dtype=float32), array(0.02445875, dtype=float32), array(0.08455219, dtype=float32), array(0.08304376, dtype=float32), array(0.11804093, dtype=float32), array(0.03419339, dtype=float32), array(0.17583553, dtype=float32), array(0.0364633, dtype=float32), array(0.0533686, dtype=float32), array(0.10989815, dtype=float32), array(0.04972738, dtype=float32), array(0.04211501, dtype=float32), array(0.05006912, dtype=float32), array(0.06278457, dtype=float32), array(0.08093909, dtype=float32), array(0.08451206, dtype=float32), array(0.04042056, dtype=float32), array(0.0952648, dtype=float32), array(0.13129555, dtype=float32), array(0.00615584, dtype=float32), array(0.10931956, dtype=float32), array(0.02891051, dtype=float32), array(0.04572261, dtype=float32), array(0.1076768, dtype=float32), array(0.02652664, dtype=float32), array(0.09286931, dtype=float32), array(0.08907318, dtype=float32), array(0.03438818, dtype=float32), array(0.10890556, dtype=float32), array(0.05661498, dtype=float32), array(0.13387404, dtype=float32), array(0.06166457, dtype=float32), array(0.08205849, dtype=float32), array(0.11965093, dtype=float32), array(0.05118785, dtype=float32), array(0.07603505, dtype=float32), array(0.06323824, dtype=float32), array(0.02085892, dtype=float32), array(0.06231527, dtype=float32), array(0.09104472, dtype=float32), array(0.01823916, dtype=float32), array(0.03497231, dtype=float32), array(0.02668404, dtype=float32), array(0.08176833, dtype=float32), array(0.08907702, dtype=float32), array(0.09110978, dtype=float32), array(0.1456532, dtype=float32), array(0.17204465, dtype=float32), array(0.02568177, dtype=float32), array(0.04387585, dtype=float32), array(0.01297651, dtype=float32), array(0.0220986, dtype=float32), array(0.26899043, dtype=float32), array(0.01839937, dtype=float32), array(0.15840475, dtype=float32), array(0.07661013, dtype=float32), array(0.05634263, dtype=float32), array(0.06558479, dtype=float32), array(0.01498412, dtype=float32), array(0.06416344, dtype=float32), array(0.0077457, dtype=float32), array(0.06777684, dtype=float32), array(0.08037621, dtype=float32), array(0.08667805, dtype=float32), array(0.14937063, dtype=float32), array(0.06870502, dtype=float32), array(0.01413966, dtype=float32), array(0.05287848, dtype=float32), array(0.02623979, dtype=float32), array(0.25889263, dtype=float32), array(0.1667519, dtype=float32), array(0.05619606, dtype=float32), array(0.03308919, dtype=float32), array(0.1287557, dtype=float32)]
[0.917568736361732, 0.8842437008478284, 0.8815659359749416, 0.8801357075278277, 0.8799555608498697, 0.8802608747887046, 0.8736507452892693, 0.8799689239026325, 0.874611357882152, 0.8729759747583388, 0.8795583600148953, 0.8739018434140385, 0.8742027030019525, 0.8745385610613878, 0.8714635317199421, 0.8726895599941253, 0.8773311209208645, 0.871861114356424, 0.8684884071062933, 0.8756139686408604, 0.8727819559589416, 0.8683505131284992, 0.8713131019259851, 0.8722776598011118, 0.8730462262357197, 0.8761965977413132, 0.8750154311442615, 0.8689092796347332, 0.8645702327691072, 0.8703928330257288, 0.864302271744423, 0.8714302513552044, 0.8737347416209205, 0.871830188434316, 0.8694421472720409, 0.8715989439879371, 0.8706077236408695, 0.8706518217149861, 0.8678593254890941, 0.8692378834655258, 0.8647176081510041, 0.8703783882020281, 0.8660588132132847, 0.8730319086791882, 0.8688228652268677, 0.8631096511021464, 0.8675000502705319, 0.8698044132690786, 0.8666435422220288, 0.8711388095378089, 0.8637639952524255, 0.8643050079885602, 0.8652591299558154, 0.8668005262751978, 0.8646828642138209, 0.8606534583707818, 0.8671896456449303, 0.8685183148910479, 0.8629163322721796, 0.8653181819223096, 0.8625550207789108, 0.8615169024800045, 0.8600421941572661, 0.860339235730105, 0.8665646365771444, 0.8589173432825715, 0.8633902752101625, 0.862455370585452, 0.8610019158799648, 0.8652592572229845, 0.8607597264570374, 0.8630884611184799, 0.8617879179167485, 0.8584539635196295, 0.8604248865349553, 0.8643052625228985, 0.8579275228743647, 0.8574379897081584, 0.8624147087249026, 0.8569319118099606, 0.8548064228176799, 0.8579910291917796, 0.8588802449027589, 0.8625761471289927, 0.8561018753326446, 0.8588561277742015, 0.8565963082848637, 0.856651033167606, 0.8559279011123915, 0.8551124367259453, 0.8511873263280393, 0.8529513129262972, 0.858611202107137, 0.8534269103374795, 0.8562720315378227, 0.8559763899038445, 0.8530704986302233, 0.8543103353922616, 0.8531629582286243, 0.8524253813497091]
